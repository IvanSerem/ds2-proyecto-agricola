# -*- coding: utf-8 -*-
"""DataScienceII.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/github/IvanSerem/ds2-proyecto-agricola/blob/main/DataScienceII.ipynb

# üåæ Proyecto ‚Äì Data Science II  
## Contextualizaci√≥n Clim√°tica del Rendimiento Agr√≠cola en Argentina (2014‚Äì2023)

---

## 1Ô∏è‚É£ Antecedentes ‚Äì Data Science I

En la primera etapa del proyecto (Data Science I) se desarroll√≥ un modelo predictivo agr√≠cola capaz de estimar el rendimiento de distintos cultivos a partir de variables del suelo y condiciones clim√°ticas.

Se trabaj√≥ con m√°s de 36.000 registros correspondientes al per√≠odo 2014‚Äì2023, construyendo un pipeline completo de Ciencia de Datos que culmin√≥ con un modelo **CatBoost Regressor**, obteniendo las siguientes m√©tricas:

- **R¬≤ ‚âà 0.9787**
- **MAE ‚âà 2.30**
- **RMSE ‚âà 3.79**

**Acceso al modelo**:
[Predictor Agr√≠cola Inteligente](https://huggingface.co/spaces/IvanSerem/PREDICTOR-DE-RENDIMIENTO-AGRICOLA)

Estos resultados evidenciaron una alta capacidad predictiva y estabilidad del modelo.

Sin embargo, el dataset original proven√≠a de Kaggle y representaba una base estructurada y preprocesada, lo que limitaba el an√°lisis del contexto clim√°tico real argentino.

---

## 2Ô∏è‚É£ Evoluci√≥n del Proyecto

En Data Science I, la pregunta central fue:

> ¬øEs posible determinar, a partir de los valores del suelo y las condiciones clim√°ticas, si una cosecha ser√° fruct√≠fera?

En esta segunda etapa, el enfoque evoluciona hacia una contextualizaci√≥n clim√°tica real:

> ¬øC√≥mo se caracterizan los patrones clim√°ticos reales ocurridos en Argentina entre 2014 y 2023 y qu√© implicancias potenciales podr√≠an tener para el rendimiento agr√≠cola a nivel provincial?

El objetivo ya no es √∫nicamente predecir rendimiento, sino comprender el entorno clim√°tico estructural donde esos rendimientos ocurren.

---

## 3Ô∏è‚É£ Construcci√≥n del Dataset Clim√°tico

Para esta etapa se incorporaron datos reales obtenidos mediante la API oficial **NASA POWER**, construyendo un dataset clim√°tico consolidado (2014‚Äì2023) que incluye:

- Temperatura media diaria (T2M)
- Temperatura m√°xima y m√≠nima
- Precipitaci√≥n diaria (PRECTOTCORR)
- Velocidad del viento (WS2M)
- Humedad relativa (RH2M)
- Ubicaci√≥n geogr√°fica por provincia

### Caracter√≠sticas del dataset:

- **83.996 registros**
- **23 provincias**
- **10 a√±os completos de datos diarios**

Este dataset permite analizar el comportamiento clim√°tico real argentino desde una perspectiva estructural y comparativa.

---

## 4Ô∏è‚É£ Alcance Anal√≠tico

El an√°lisis desarrollado en esta etapa incluye:

- An√°lisis univariado
- An√°lisis bivariado
- An√°lisis multivariado
- Estudio de rachas de lluvia
- An√°lisis estacional
- Evaluaci√≥n de correlaciones estructurales
- Identificaci√≥n de agrupamientos clim√°ticos provinciales

Este enfoque permite detectar patrones, variabilidad regional y eventos potencialmente relevantes para la planificaci√≥n agr√≠cola.

---

## 5Ô∏è‚É£ Justificaci√≥n del Estudio

El rendimiento agr√≠cola no depende √∫nicamente del suelo, sino tambi√©n del comportamiento clim√°tico acumulado y de la ocurrencia de eventos extremos.

Factores como:

- Rachas prolongadas de lluvia  
- Sequ√≠as estacionales  
- Humedad persistente  
- Vientos intensos  
- Variaciones t√©rmicas  

pueden alterar significativamente el resultado productivo, incluso cuando el suelo presenta condiciones √≥ptimas.

Comprender la din√°mica clim√°tica argentina permite:

- Interpretar mejor los resultados del modelo predictivo desarrollado en Data Science I.
- Detectar provincias con mayor riesgo clim√°tico estructural.
- Identificar patrones regionales diferenciados.
- Evaluar tendencias de variabilidad en precipitaci√≥n y temperatura.
- Contextualizar potenciales riesgos productivos.

---

## üéØ Objetivo del Proyecto ‚Äì Data Science II

Analizar y caracterizar los patrones clim√°ticos reales ocurridos en Argentina durante el per√≠odo 2014‚Äì2023, utilizando datos provenientes de APIs oficiales, con el fin de contextualizar el rendimiento agr√≠cola y detectar estructuras clim√°ticas relevantes a nivel provincial.

---

# üîé Preguntas de Investigaci√≥n ‚Äì An√°lisis Clim√°tico Provincial (2014‚Äì2023)

## üå°Ô∏è Temperatura

1. ¬øCu√°les son las provincias con mayor temperatura media anual durante el per√≠odo analizado?
2. ¬øExiste una relaci√≥n entre la temperatura media anual y la precipitaci√≥n total anual en las distintas provincias de Argentina?

## üåßÔ∏è Precipitaci√≥n

3. ¬øCu√°les son las provincias con mayor precipitaci√≥n acumulada promedio?
4. ¬øC√≥mo se distribuye la precipitaci√≥n diaria a lo largo del per√≠odo estudiado?
5. ¬øLa precipitaci√≥n se concentra en pocos eventos intensos o se distribuye de manera uniforme en el tiempo?
6. ¬øQu√© provincias presentan mayor cantidad de eventos o rachas de lluvia durante el per√≠odo 2014‚Äì2023?
7. ¬øCu√°l es la frecuencia de d√≠as sin precipitaciones?

## üíß Humedad

8. ¬øCu√°les son las provincias con mayor humedad relativa promedio?
9. ¬øExiste una relaci√≥n entre la humedad relativa media y la precipitaci√≥n anual?

## üí® Viento

10. ¬øQu√© provincias presentan el mayor porcentaje de d√≠as con viento intenso?

## üìä An√°lisis Multivariable

11. ¬øSe observan agrupamientos naturales de provincias con caracter√≠sticas clim√°ticas similares?
12. ¬øQu√© relaciones estructurales se identifican entre temperatura, precipitaci√≥n, viento y humedad a nivel provincial?

## üó∫Ô∏è Visualizaci√≥n Espacial

13. ¬øC√≥mo se distribuyen espacialmente las principales variables clim√°ticas mediante un mapa interactivo provincial?

14. ¬øEs posible identificar perfiles clim√°ticos diferenciados entre las provincias argentinas a partir de sus variables promedio de temperatura, precipitaci√≥n, viento y humedad durante el per√≠odo 2014‚Äì2023?

## 1.1 Importaci√≥n de Librer√≠as y Definici√≥n de Par√°metros

### üîπ Introducci√≥n

En esta secci√≥n importamos las librer√≠as necesarias para la manipulaci√≥n de datos, visualizaci√≥n y consumo de APIs.  
Adem√°s, definimos los par√°metros temporales que delimitar√°n nuestro an√°lisis, permitiendo mantener coherencia y control sobre el rango de informaci√≥n a consultar.
"""

# Importamos las librer√≠as esenciales
import pandas as pd
import requests
import matplotlib.pyplot as plt
import seaborn as sns

# Configuramos un estilo visual para todos nuestros gr√°ficos
sns.set_theme(style="whitegrid")

# Definimos los par√°metros de la petici√≥n
url_base = "https://power.larc.nasa.gov/api/temporal/daily/point"
a√±os_a_consultar = list(range(2014, 2024))

"""### üîπ Conclusi√≥n

Como se observa, se establece un rango de a√±os entre 2014 y 2023 inclusive, lo que nos permite analizar una d√©cada completa de datos clim√°ticos.  

Este recorte temporal asegura consistencia hist√≥rica y facilita comparaciones interanuales en etapas posteriores del an√°lisis.

---

## 1.2 Extracci√≥n de Datos en Lotes

### üîπ Introducci√≥n

Para facilitar la manipulaci√≥n y evitar errores en la consulta de datos, realizamos la extracci√≥n de informaci√≥n en lotes anuales.  

La solicitud se ejecuta iterando sobre los a√±os definidos previamente y utilizando las coordenadas de latitud y longitud correspondientes a distintas provincias argentinas.  

Este enfoque permite mantener control sobre el volumen de datos descargados y reduce el riesgo de fallos en la conexi√≥n o limitaciones de la API.
"""

import pandas as pd
import requests
import time

# =========================
# Configuraci√≥n base NASA POWER
# =========================
url_base = "https://power.larc.nasa.gov/api/temporal/daily/point"
a√±os_a_consultar = list(range(2014, 2024))

# Provincias argentinas (capital provincial como punto representativo)
provincias = {
    "Buenos Aires": (-34.61, -58.38),
    "Catamarca": (-28.47, -65.78),
    "Chaco": (-27.45, -58.99),
    "Chubut": (-43.30, -65.10),
    "C√≥rdoba": (-31.42, -64.18),
    "Corrientes": (-27.47, -58.83),
    "Entre R√≠os": (-31.73, -60.53),
    "Formosa": (-26.18, -58.17),
    "Jujuy": (-24.18, -65.33),
    "La Pampa": (-36.62, -64.29),
    "La Rioja": (-29.41, -66.86),
    "Mendoza": (-32.89, -68.83),
    "Misiones": (-27.37, -55.90),
    "Neuqu√©n": (-38.95, -68.06),
    "R√≠o Negro": (-40.81, -63.00),
    "Salta": (-24.78, -65.41),
    "San Juan": (-31.53, -68.52),
    "San Luis": (-33.30, -66.34),
    "Santa Cruz": (-51.62, -69.22),
    "Santa Fe": (-31.63, -60.70),
    "Santiago del Estero": (-27.78, -64.27),
    "Tierra del Fuego": (-54.80, -68.30),
    "Tucum√°n": (-26.82, -65.22)
}

# Ac√° guardamos TODO (todas las provincias, todos los a√±os)
lista_dataframes = []

print("--- Realizando la petici√≥n en lotes (por provincia y por a√±o) con NASA POWER ---")

for provincia, (lat, lon) in provincias.items():
    print(f"\nüìç Provincia: {provincia} | lat={lat}, lon={lon}")

    for anio in a√±os_a_consultar:
        print(f"  Obteniendo datos para el a√±o {anio}...")

        params = {
            "latitude": lat,
            "longitude": lon,
            "start": f"{anio}0101",
            "end": f"{anio}1231",
            "parameters": "T2M,T2M_MAX,T2M_MIN,PRECTOTCORR,WS2M,RH2M",
            "community": "AG",
            "format": "JSON"
        }

        try:
            response = requests.get(url_base, params=params, timeout=60)
            response.raise_for_status()

            payload = response.json()

            # NASA POWER no trae "data": trae "properties/parameter"
            data_params = payload["properties"]["parameter"]

            # data_params: {variable: {YYYYMMDD: valor}}
            df_anual = pd.DataFrame(data_params)

            # convertir √≠ndice YYYYMMDD a fecha
            df_anual["date"] = pd.to_datetime(df_anual.index, format="%Y%m%d")
            df_anual["anio"] = anio
            df_anual["provincia"] = provincia
            df_anual["lat"] = lat
            df_anual["lon"] = lon

            lista_dataframes.append(df_anual.reset_index(drop=True))
            print(f"    ‚úÖ Datos {provincia} {anio}: {len(df_anual)} registros.")

            time.sleep(0.2)

        except requests.exceptions.RequestException as e:
            print(f"    ‚ùå Error en {provincia} {anio}: {e}")

"""### üîπ Conclusi√≥n

La extracci√≥n segmentada por a√±o y por ubicaci√≥n geogr√°fica garantiza mayor estabilidad en el proceso de adquisici√≥n de datos.  

Adem√°s, este m√©todo facilita futuras validaciones, reprocesamientos parciales y control de calidad en etapas posteriores del proyecto.API.

---

## 1.3 Inspecci√≥n de los Resultados del Bucle

### üîπ Introducci√≥n

Antes de consolidar todos los datos en un √∫nico DataFrame, es fundamental verificar qu√© informaci√≥n fue recolectada durante la ejecuci√≥n del bucle.

La variable `lista_dataframes` deber√≠a contener un DataFrame por cada a√±o consultado exitosamente.  
Por ello, realizamos una inspecci√≥n inicial para validar:

- Cantidad de DataFrames recolectados.
- Estructura del primer DataFrame.
- Forma (filas y columnas).
- Primeras observaciones del conjunto de datos.

Esta etapa nos permite detectar posibles errores antes de avanzar a la concatenaci√≥n final.
"""

# Verificamos cu√°ntos DataFrames hemos recolectado
# Deber√≠a ser uno por cada a√±o que no dio error.
print(f"Se han recolectado {len(lista_dataframes)} DataFrames en total.")

# Inspeccionemos el primer DataFrame de la lista para ver su estructura y contenido
# Este corresponde a los datos del primer a√±o que consultamos (2020)
if lista_dataframes:
    print("\n--- Analizando el PRIMER DataFrame de la lista (datos del a√±o 2020) ---")

    # Seleccionamos el primer elemento de la lista
    primer_df = lista_dataframes[0]

    # Mostramos su forma y sus primeras filas
    print(f"Forma del primer DataFrame: {primer_df.shape}")
    print("Primeras 3 filas:")
    display(primer_df.head(3))

"""### üîπ Conclusi√≥n

Esta verificaci√≥n preliminar nos permite asegurar que la extracci√≥n de datos fue exitosa y que cada a√±o consultado gener√≥ un DataFrame con la estructura esperada.

Validar la cantidad de elementos y revisar la forma del primer DataFrame reduce el riesgo de errores posteriores en la etapa de concatenaci√≥n y an√°lisis exploratorio (EDA).

De esta manera, mantenemos control sobre la calidad y consistencia de los datos desde las primeras fases del proyecto.

---

## 1.4 Consolidaci√≥n y Verificaci√≥n

### üîπ Introducci√≥n

Una vez completada la extracci√≥n en lotes, procedemos a consolidar todos los DataFrames almacenados en `lista_dataframes` en una √∫nica tabla maestra.

Para ello utilizamos `pd.concat()`, lo que nos permite unificar la informaci√≥n de todas las provincias y a√±os en un solo DataFrame estructurado.

Posteriormente realizamos una verificaci√≥n inicial para validar:

- Dimensi√≥n del dataset final
- Tipos de datos
- Cobertura temporal
- Cantidad de provincias incluidas

Este paso es fundamental para confirmar la integridad del conjunto de datos antes de avanzar hacia etapas de limpieza o an√°lisis exploratorio.
"""

# 1.4. Consolidaci√≥n y Verificaci√≥n

# Verificamos que la lista no est√© vac√≠a antes de continuar
if lista_dataframes:
    # Unimos todos los DataFrames (todas las provincias y a√±os)
    df_clima_crudo = pd.concat(lista_dataframes, ignore_index=True)

    print("\n--- ¬°DataFrame Consolidado Creado Exitosamente! ---")
    print(f"Forma del DataFrame final: {df_clima_crudo.shape}")

    # Informaci√≥n general para un primer diagn√≥stico
    print("\n--- Informaci√≥n General ---")
    df_clima_crudo.info()

    # Verificaci√≥n r√°pida de cobertura
    print("\n--- Verificaciones b√°sicas ---")
    print("Provincias incluidas:", df_clima_crudo["provincia"].nunique())
    print("A√±os incluidos:", df_clima_crudo["anio"].unique())
    print("Rango de fechas:", df_clima_crudo["date"].min(), "‚Üí", df_clima_crudo["date"].max())
else:
    print("No se pudieron cargar los datos.")

"""### üîπ Conclusi√≥n

El proceso de consolidaci√≥n gener√≥ un dataset con 83.996 registros y 11 variables, cubriendo 23 provincias argentinas y un per√≠odo completo entre 2014 y 2023.

La verificaci√≥n confirma que:

- No existen valores nulos iniciales.
- Las variables clim√°ticas fueron correctamente tipadas como num√©ricas.
- La variable de fecha fue reconocida como tipo `datetime`.
- La cobertura temporal es consistente y continua.

Con esta estructura consolidada, el dataset se encuentra listo para avanzar hacia la fase de limpieza optimizada (Data Wrangling) y posterior An√°lisis Exploratorio de Datos (EDA).

---

# M√≥dulo 2: Data Wrangling del Dataset Clim√°tico

El dataset clim√°tico proveniente de la API NASA POWER presenta una estructura tabular organizada, sin datos anidados ni metadata t√©cnica redundante.

Sin embargo, para su correcta utilizaci√≥n en an√°lisis exploratorio y modelado predictivo, resulta necesario optimizar su estructura, estandarizar su sem√°ntica y enriquecer sus variables.

En este m√≥dulo se realiza el proceso de Data Wrangling, orientado a transformar el dataset crudo en una base anal√≠tica consistente y preparada para la toma de decisiones.

---

## Acciones realizadas

### üîπ 1. Selecci√≥n de Variables (Feature Selection)

Se conservaron √∫nicamente las variables clim√°ticas relevantes para el an√°lisis agr√≠cola, eliminando columnas que no aportaban valor directo al objetivo del proyecto.

Esta reducci√≥n de dimensionalidad mejora la eficiencia computacional y simplifica el an√°lisis posterior.

---

### üîπ 2. Estandarizaci√≥n y Renombrado de Columnas

Las variables originales fueron renombradas bajo una nomenclatura clara y coherente en espa√±ol, facilitando la interpretaci√≥n y comunicaci√≥n del an√°lisis.

Este ajuste sem√°ntico mejora la legibilidad del c√≥digo y reduce la ambig√ºedad conceptual.

---

### üîπ 3. Transformaci√≥n de Tipos de Datos

Se verificaron y ajustaron los tipos de datos, especialmente la variable temporal, asegurando su correcta conversi√≥n al formato `datetime`.

Una tipificaci√≥n adecuada permite realizar an√°lisis temporales, agregaciones y segmentaciones con precisi√≥n.

---

### üîπ 4. Creaci√≥n de Nuevas Variables (Feature Engineering)

Se generaron variables derivadas a partir de las originales, incluyendo conversiones de unidades y componentes temporales.

El objetivo fue enriquecer el dataset para capturar patrones clim√°ticos relevantes que puedan influir en el rendimiento agr√≠cola y en futuros modelos predictivos.

## 2.1 Exploraci√≥n Inicial de Columnas

### üîπ Introducci√≥n

Antes de realizar cualquier proceso de selecci√≥n o transformaci√≥n, es importante inspeccionar la estructura del dataset consolidado.

En este caso, listamos todas las columnas presentes en `df_clima_crudo` para:

- Identificar las variables disponibles.
- Verificar consistencia en los nombres.
- Detectar posibles campos innecesarios.
- Preparar la etapa de selecci√≥n y renombrado.

Esta inspecci√≥n nos permite entender con precisi√≥n la composici√≥n del dataset antes de modificarlo.
"""

for columna in df_clima_crudo.columns:
  print(columna)

"""### üîπ Conclusi√≥n

El dataset contiene variables clim√°ticas principales (temperatura, precipitaci√≥n, viento, humedad), variables temporales y variables geogr√°ficas.

Esta estructura confirma que contamos con informaci√≥n suficiente para realizar an√°lisis temporal, espacial y clim√°tico, lo que permitir√° avanzar hacia una selecci√≥n de variables estrat√©gicamente orientada al objetivo agr√≠cola del proyecto.

---

## 2.2 Selecci√≥n y Renombrado de Variables Clim√°ticas

### üîπ Introducci√≥n

Las variables originales del dataset proveniente de NASA POWER se encuentran expresadas en nomenclatura cient√≠fica y terminolog√≠a t√©cnica en ingl√©s.

Si bien son correctas desde el punto de vista acad√©mico, para facilitar la interpretaci√≥n, el an√°lisis y la comunicaci√≥n del proyecto, se procede a:

- Seleccionar √∫nicamente las columnas relevantes.
- Renombrar las variables con una sem√°ntica clara en espa√±ol.
- Mantener coherencia conceptual para etapas posteriores de modelado.

Este proceso mejora la legibilidad del c√≥digo y fortalece la calidad anal√≠tica del dataset.
"""

# ============================================
# M√ìDULO 2 ‚Äì DATA WRANGLING
# Dataset Clim√°tico ‚Äì NASA POWER
# ============================================

import pandas as pd

# ------------------------------------------------
# 1. PARTIMOS DEL DATAFRAME CRUDO
# ------------------------------------------------
# Se asume que df_clima_crudo ya fue creado en el M√≥dulo 1
# (adquisici√≥n y consolidaci√≥n de datos)

print("Forma del DataFrame crudo:")
print(df_clima_crudo.shape)

# ------------------------------------------------
# 2. SELECCI√ìN DE COLUMNAS RELEVANTES
# ------------------------------------------------
columnas_relevantes = [
    "T2M",
    "T2M_MAX",
    "T2M_MIN",
    "PRECTOTCORR",
    "WS2M",
    "RH2M",
    "date",
    "anio",
    "provincia",
    "lat",
    "lon"
]

df_clima_limpio = df_clima_crudo[columnas_relevantes].copy()

print("\nColumnas seleccionadas:")
print(df_clima_limpio.columns)

# ------------------------------------------------
# 3. RENOMBRADO DE COLUMNAS (CLARIDAD SEM√ÅNTICA)
# ------------------------------------------------
df_clima_limpio = df_clima_limpio.rename(columns={
    "T2M": "temp_media",
    "T2M_MAX": "temp_max",
    "T2M_MIN": "temp_min",
    "PRECTOTCORR": "precipitacion",
    "WS2M": "vel_viento",
    "RH2M": "humedad",
    "date": "fecha",
    "anio": "anio",
    "provincia": "provincia",
    "lat": "latitud",
    "lon": "longitud"
})

# ------------------------------------------------
# 4. VERIFICACI√ìN GENERAL DEL DATASET
# ------------------------------------------------
print("\n--- Informaci√≥n del DataFrame Limpio ---")
df_clima_limpio.info()

print("\n--- Primeras filas del DataFrame Limpio ---")
df_clima_limpio.head()

"""### üîπ Conclusi√≥n

El dataset fue reducido a las variables clim√°ticas esenciales y renombrado bajo una nomenclatura clara y coherente en espa√±ol.

Este ajuste:

- Mejora la interpretaci√≥n de resultados.
- Facilita la comunicaci√≥n del an√°lisis.
- Reduce fricci√≥n cognitiva en etapas de EDA y modelado.
- Prepara el dataset para futuras transformaciones y generaci√≥n de variables derivadas.

Con esta estructura sem√°ntica optimizada, el DataFrame se encuentra listo para continuar con la fase de Feature Engineering y an√°lisis exploratorio.

## 2.3 Conversi√≥n de Velocidad del Viento a km/h

### üîπ Introducci√≥n

La variable original `vel_viento` se encuentra expresada en metros por segundo (m/s), unidad est√°ndar utilizada en datos meteorol√≥gicos internacionales.

Sin embargo, para facilitar la interpretaci√≥n pr√°ctica y hacer los valores m√°s intuitivos dentro del contexto local, se decide convertir esta m√©trica a kil√≥metros por hora (km/h).

La conversi√≥n se realiza multiplicando por 3.6, dado que:

1 m/s = 3.6 km/h

Adem√°s, se redondea el resultado a un decimal para mejorar la legibilidad sin perder precisi√≥n relevante.
"""

df_clima_limpio["vel_viento_kmh"] = (
    df_clima_limpio["vel_viento"] * 3.6
).round(1)

df_clima_limpio.head()

"""La nueva variable `vel_viento_kmh` permite una lectura m√°s clara y alineada con el sistema de medici√≥n com√∫nmente utilizado en Argentina.

Este tipo de transformaci√≥n mejora la interpretabilidad del dataset sin alterar la informaci√≥n original, y resulta especialmente √∫til en contextos productivos donde la velocidad del viento impacta directamente en actividades agr√≠colas.

Con esta variable derivada, el dataset gana claridad operativa y queda mejor preparado para an√°lisis descriptivos y modelos predictivos.

---

## Conclusi√≥n del M√≥dulo

Este proceso de Data Wrangling convierte un conjunto de datos crudo en una base estructurada, optimizada y anal√≠ticamente robusta.

M√°s all√° de la limpieza t√©cnica, este m√≥dulo establece los fundamentos para un an√°lisis exploratorio s√≥lido y para el desarrollo de modelos predictivos confiables.

# üìä M√≥dulo 3: EDA y Data Storytelling  

Con el dataset ya limpio, estructurado y enriquecido en el m√≥dulo anterior, entramos ahora en una etapa clave del proceso de Ciencia de Datos: **el An√°lisis Exploratorio de Datos (EDA)** y la construcci√≥n de una narrativa basada en evidencia.

En este m√≥dulo comenzamos a **hacerle preguntas concretas a los datos** y utilizamos visualizaciones para responderlas de forma clara e interpretativa.

El objetivo no es solo observar n√∫meros, sino:

- üîé Detectar patrones clim√°ticos relevantes  
- üåßÔ∏è Identificar comportamientos de lluvia, humedad, viento y temperatura  
- üìà Analizar relaciones entre variables  
- üß† Comprender din√°micas regionales  
- üìñ Transformar los datos en una historia comprensible  

El **EDA** nos permite entender la estructura interna del dataset antes de modelar.  
El **Data Storytelling** nos ayuda a comunicar esos hallazgos con claridad.

En esta etapa analizamos:

- Provincias m√°s c√°lidas  
- Provincias con mayor precipitaci√≥n acumulada  
- Distribuci√≥n de lluvias diarias  
- Relaci√≥n entre humedad y lluvia  
- Eventos intensos y rachas  
- Riesgo de evaporaci√≥n  
- Frecuencia de viento fuerte  
- Visualizaci√≥n geogr√°fica interactiva  

Cada gr√°fico responde una pregunta espec√≠fica.  
Cada m√©trica aporta contexto.

## ¬øCu√°les son las Provincias con Mayor Temperatura Media?

Como parte del An√°lisis Exploratorio de Datos (EDA), se analiza la temperatura media anual (`T2M`) por provincia para identificar cu√°les presentan los valores promedio m√°s elevados durante el per√≠odo 2014‚Äì2023.

Este an√°lisis permite:

- Detectar patrones clim√°ticos regionales.
- Identificar zonas con mayor acumulaci√≥n t√©rmica.
- Comprender posibles impactos en la producci√≥n agr√≠cola.

Para ello, se calcula la media de temperatura por provincia y se ordenan los resultados de mayor a menor.
"""

# ==============================
# TOP 10 PROVINCIAS M√ÅS CALUROSAS
# ==============================

# 1Ô∏è‚É£ Calculamos la temperatura promedio por provincia
top_10_calor = (
    df_clima_crudo
    .groupby("provincia")["T2M"]
    .mean()
    .sort_values(ascending=False)
    .head(10)
)

# 2Ô∏è‚É£ Visualizaci√≥n
plt.figure(figsize=(12, 8))

sns.barplot(
    y=top_10_calor.index,
    x=top_10_calor.values,
    palette="viridis"
)

plt.title("Top 10 Provincias M√°s Calurosas (Promedio T2M 2014‚Äì2023)", fontsize=16)
plt.xlabel("Temperatura Media (¬∞C)", fontsize=12)
plt.ylabel("Provincia", fontsize=12)

plt.show()

# 3Ô∏è‚É£ Mostrar valores num√©ricos
display(top_10_calor)

"""### üîπ Conclusi√≥n y Observaci√≥n de los Datos

El an√°lisis revela que las provincias del noreste argentino (Formosa, Chaco, Corrientes y Misiones) lideran el ranking de temperaturas medias m√°s elevadas.

Tambi√©n se destacan provincias del noroeste como Tucum√°n y Santiago del Estero, lo que confirma la influencia de factores clim√°ticos regionales caracter√≠sticos de zonas subtropicales y semi√°ridas.

La diferencia t√©rmica entre la primera y la d√©cima provincia no es extremadamente amplia, lo que indica que gran parte del norte argentino mantiene promedios t√©rmicos elevados de manera sostenida.

Desde una perspectiva agr√≠cola, estas condiciones pueden:

- Favorecer cultivos que requieren alta acumulaci√≥n t√©rmica.
- Incrementar el riesgo de estr√©s h√≠drico si no se acompa√±a con niveles adecuados de precipitaci√≥n.
- Impactar en la planificaci√≥n de calendarios productivos.

Este resultado confirma la coherencia clim√°tica esperada y valida la consistencia del dataset consolidado.

---

## ¬øCuales son las Provincias con Mayor Precipitaci√≥n Acumulada?

En esta secci√≥n del An√°lisis Exploratorio de Datos (EDA), se estudia la precipitaci√≥n total acumulada por provincia durante el per√≠odo 2014‚Äì2023.

El objetivo es identificar cu√°les regiones presentan mayor disponibilidad h√≠drica a lo largo de la d√©cada analizada.

A diferencia del an√°lisis anterior de temperatura media, en este caso se realiza una agregaci√≥n por suma, ya que interesa conocer el volumen total de lluvia acumulado en mil√≠metros.

Este an√°lisis es clave para comprender:

- La distribuci√≥n regional de recursos h√≠dricos.
- El potencial agr√≠cola por disponibilidad de agua.
- La exposici√≥n a eventos de exceso h√≠drico.
"""

import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# ==============================
# TOP 10 PROVINCIAS M√ÅS LLUVIOSAS
# (PRECIPITACI√ìN TOTAL ACUMULADA)
# ==============================

# 1) Agregaci√≥n: suma de precipitaci√≥n por provincia
top_10_lluvia = (
    df_clima_crudo
    .groupby("provincia")["PRECTOTCORR"]
    .sum()
    .sort_values(ascending=False)
    .head(10)
)

# 2) Plot
plt.figure(figsize=(12, 8))

sns.barplot(
    y=top_10_lluvia.index,
    x=top_10_lluvia.values,
    palette="viridis"
)

plt.title("Top 10 Provincias con M√°s Precipitaci√≥n (Acumulado 2014‚Äì2023)", fontsize=16)
plt.xlabel("Precipitaci√≥n Total Acumulada (mm)", fontsize=12)
plt.ylabel("Provincia", fontsize=12)

# 3) Formato de ticks para que se lea mejor
plt.ticklabel_format(style='plain', axis='x')  # evita notaci√≥n cient√≠fica
plt.grid(True, axis="x", linestyle="--", alpha=0.3)

plt.show()

# 4) Mostrar valores num√©ricos
display(top_10_lluvia.to_frame(name="precipitacion_total_mm"))

"""El an√°lisis muestra que la provincia de Misiones lidera ampliamente el ranking de precipitaci√≥n acumulada, lo cual es consistente con su clima subtropical h√∫medo.

Las provincias del noreste argentino (NEA) ‚ÄîMisiones, Formosa, Chaco y Corrientes‚Äî concentran los mayores vol√∫menes de lluvia, confirmando una marcada diferencia respecto a regiones m√°s √°ridas del pa√≠s.

Tambi√©n se observa la presencia de provincias de la regi√≥n pampeana como Santa Fe y Buenos Aires, lo que refuerza su relevancia productiva en t√©rminos agr√≠colas.

Desde una perspectiva agroclim√°tica, estas provincias presentan:

- Alta disponibilidad h√≠drica sostenida.
- Potencial favorable para cultivos extensivos.
- Mayor riesgo de excesos h√≠dricos y eventos extremos en determinados per√≠odos.

El patr√≥n observado resulta coherente con la distribuci√≥n clim√°tica argentina y valida la consistencia del dataset analizado.

---

## ¬øExiste una relaci√≥n entre la temperatura media anual y la precipitaci√≥n total anual en las distintas provincias de Argentina?


En este bloque de c√≥digo se realiza un an√°lisis exploratorio para evaluar la relaci√≥n entre **temperatura media anual** y **precipitaci√≥n total anual** en distintas provincias de Argentina a lo largo del per√≠odo estudiado.

Primero, los datos clim√°ticos crudos se agrupan por **provincia y a√±o**, calculando:

- La **temperatura media anual** (promedio de `T2M`).
- La **precipitaci√≥n total anual acumulada** (suma de `PRECTOTCORR`).

Luego, se construye un **gr√°fico de dispersi√≥n** que permite visualizar c√≥mo se relacionan ambas variables para cada combinaci√≥n provincia-a√±o.

Este tipo de visualizaci√≥n es √∫til para detectar patrones generales, posibles correlaciones y comportamientos at√≠picos que podr√≠an influir en la productividad agr√≠cola.

---
"""

import matplotlib.pyplot as plt

# 1Ô∏è‚É£ Agrupamos por provincia y a√±o
df_simple = (
    df_clima_crudo
    .groupby(["provincia", "anio"], as_index=False)
    .agg(
        temp_media=("T2M", "mean"),
        lluvia_total=("PRECTOTCORR", "sum")
    )
)

# 2Ô∏è‚É£ Creamos gr√°fico simple
plt.figure(figsize=(8,6))
plt.scatter(df_simple["temp_media"], df_simple["lluvia_total"], alpha=0.6)

plt.title("Temperatura media vs Lluvia total (Provincia-A√±o)")
plt.xlabel("Temperatura media (¬∞C)")
plt.ylabel("Precipitaci√≥n total anual (mm)")

plt.show()

"""## Conclusi√≥n del An√°lisis

A partir del gr√°fico obtenido se observa:

- Una **tendencia general positiva moderada**: provincias con mayores temperaturas medias tienden a presentar mayores niveles de precipitaci√≥n acumulada.
- Existe una **alta dispersi√≥n de los datos**, lo que indica que la relaci√≥n no es perfectamente lineal.
- Se identifican algunos puntos con **precipitaciones excepcionalmente altas**, que podr√≠an representar regiones con climas m√°s h√∫medos o eventos extremos.

En t√©rminos agr√≠colas, esto sugiere que ciertas regiones combinan **temperaturas elevadas y buena disponibilidad h√≠drica**, condiciones que pueden favorecer determinados cultivos. Sin embargo, la variabilidad observada indica que el rendimiento productivo depender√° tambi√©n de otros factores complementarios como el tipo de suelo, manejo agron√≥mico y especie cultivada.

---

# ¬øCu√°l es la Evoluci√≥n de la Precipitaci√≥n Total en Argentina (2014‚Äì2023)?

Hasta ahora vimos comparaciones por provincia, pero ahora hacemos una pregunta m√°s macro:

¬øC√≥mo evolucion√≥ la lluvia total en Argentina a lo largo del tiempo?

Este an√°lisis nos permite:
- Detectar a√±os m√°s h√∫medos o m√°s secos
- Observar posibles tendencias
- Identificar anomal√≠as clim√°ticas
- Evaluar estabilidad o variabilidad interanual
"""

import matplotlib.pyplot as plt

# 1Ô∏è‚É£ Agrupamos por a√±o
lluvia_anual = (
    df_clima_crudo
    .groupby("anio", as_index=False)
    .agg(lluvia_total=("PRECTOTCORR", "sum"))
)

# 2Ô∏è‚É£ Creamos gr√°fico de l√≠nea
plt.figure(figsize=(10,6))
plt.plot(lluvia_anual["anio"], lluvia_anual["lluvia_total"], marker="o")

plt.title("Evoluci√≥n de la Precipitaci√≥n Total en Argentina (2014‚Äì2023)")
plt.xlabel("A√±o")
plt.ylabel("Precipitaci√≥n total acumulada (mm)")
plt.xticks(lluvia_anual["anio"])

plt.show()

# Mostrar valores num√©ricos
display(lluvia_anual)

"""## Observaciones de los datos

- Se observa una **alta variabilidad interanual**.
- Los a√±os **2014 y 2016** presentan valores elevados de precipitaci√≥n.
- A partir de **2018** se aprecia una ca√≠da significativa.
- **2020 y especialmente 2022** muestran valores considerablemente m√°s bajos.
- **2023** evidencia una leve recuperaci√≥n.

Esto indica que el r√©gimen de lluvias **no es estable** y presenta ciclos o fluctuaciones importantes.

## ¬øQu√© significa esto para un productor agr√≠cola?

- Hay a√±os con mayor disponibilidad h√≠drica.
- Hay a√±os con posible **estr√©s h√≠drico**.
- No se puede asumir un comportamiento lineal del clima.
- La variabilidad clim√°tica debe considerarse en la planificaci√≥n productiva.
- La gesti√≥n del riesgo (riego, reservas de agua, cultivos adaptados) se vuelve clave.

---

## ¬øHay una Relaci√≥n entre Humedad Relativa y Precipitaci√≥n Anual?

En esta secci√≥n se analiza la relaci√≥n entre la humedad relativa media anual y la precipitaci√≥n total acumulada por provincia y a√±o.

El objetivo es evaluar si existe una asociaci√≥n estad√≠stica entre:

- La humedad promedio del ambiente.
- El volumen total de lluvia acumulada en el a√±o.

Para ello:

1. Se agrupan los datos por provincia y a√±o.
2. Se calcula la humedad media anual.
3. Se calcula la precipitaci√≥n total anual.
4. Se visualiza la relaci√≥n mediante un gr√°fico de dispersi√≥n.
5. Se calcula la correlaci√≥n utilizando los m√©todos de Pearson y Spearman.

Este an√°lisis permite detectar patrones clim√°ticos estructurales y validar coherencia interna del dataset.
"""

import matplotlib.pyplot as plt

# 1Ô∏è‚É£ Agrupamos por provincia y a√±o
df_humedad = (
    df_clima_crudo
    .groupby(["provincia", "anio"], as_index=False)
    .agg(
        humedad_media=("RH2M", "mean"),
        lluvia_total=("PRECTOTCORR", "sum"),
        lluvia_media=("PRECTOTCORR", "mean")
    )
)

# 2Ô∏è‚É£ Scatter simple
plt.figure(figsize=(8,6))
plt.scatter(df_humedad["humedad_media"], df_humedad["lluvia_total"], alpha=0.6)

plt.title("Humedad media vs Lluvia total (Provincia-A√±o)")
plt.xlabel("Humedad relativa media (%)")
plt.ylabel("Precipitaci√≥n total anual (mm)")

plt.show()

# 3Ô∏è‚É£ Correlaci√≥n
corr_pearson = df_humedad["humedad_media"].corr(df_humedad["lluvia_total"])
corr_spearman = df_humedad["humedad_media"].corr(df_humedad["lluvia_total"], method="spearman")

print(f"Correlaci√≥n Pearson: {corr_pearson:.3f}")
print(f"Correlaci√≥n Spearman: {corr_spearman:.3f}")

"""El gr√°fico de dispersi√≥n muestra una tendencia positiva clara: a medida que aumenta la humedad relativa media anual, tambi√©n tiende a incrementarse la precipitaci√≥n total acumulada.

Los coeficientes obtenidos:

- **Correlaci√≥n de Pearson ‚âà 0.64**
- **Correlaci√≥n de Spearman ‚âà 0.63**

Indican una correlaci√≥n positiva moderada-alta entre ambas variables.

Esto sugiere que:

- Provincias m√°s h√∫medas suelen registrar mayores vol√∫menes de lluvia.
- Existe coherencia f√≠sica en los datos (consistencia climatol√≥gica).
- La humedad puede funcionar como variable explicativa relevante en futuros modelos predictivos.

Desde una perspectiva agroclim√°tica, esta relaci√≥n es esperable: regiones con mayor disponibilidad h√≠drica suelen presentar mayores niveles de humedad ambiental sostenida.

---

## ¬øComo es la Distribuci√≥n de la Precipitaci√≥n Diaria?

En esta secci√≥n se analiza la distribuci√≥n de la precipitaci√≥n diaria durante el per√≠odo 2014‚Äì2023.

A diferencia de los an√°lisis anteriores, que se centraron en valores agregados (medias o acumulados), aqu√≠ se estudia la frecuencia con la que ocurren distintos niveles de lluvia diaria.

El objetivo es comprender:

- C√≥mo se distribuyen los eventos de lluvia.
- Si predominan d√≠as secos o lluvias intensas.
- La presencia de valores extremos.

Para ello, se construye un histograma utilizando la variable `PRECTOTCORR`.
"""

import matplotlib.pyplot as plt
import numpy as np

# ==========================================
# HISTOGRAMA DE PRECIPITACI√ìN DIARIA
# ==========================================

plt.figure(figsize=(10,6))

plt.hist(df_clima_crudo["PRECTOTCORR"], bins=50)

plt.title("Distribuci√≥n de la Precipitaci√≥n Diaria (2014‚Äì2023)")
plt.xlabel("Precipitaci√≥n diaria (mm)")
plt.ylabel("Frecuencia")

plt.show()

"""## ¬øCu√°l es la frecuencia de dias sin precipitacion?

En esta secci√≥n se analiza la proporci√≥n de d√≠as sin lluvia dentro del per√≠odo total estudiado.

El objetivo es cuantificar qu√© tan frecuente es la ausencia de precipitaciones, lo cual permite comprender mejor la distribuci√≥n real del r√©gimen h√≠drico anual.

M√°s all√° del volumen total de lluvia acumulada, resulta clave responder:

**¬øCon qu√© frecuencia ocurren d√≠as sin precipitaciones dentro del per√≠odo analizado?**

Este indicador es relevante para el sector agr√≠cola, ya que no solo importa cu√°nto llueve en total, sino c√≥mo se distribuyen esos eventos a lo largo del tiempo. Una alta proporci√≥n de d√≠as secos podr√≠a implicar mayor necesidad de riego, estr√©s h√≠drico en cultivos o mayor variabilidad productiva.

"""

dias_totales = len(df_clima_crudo)
dias_sin_lluvia = (df_clima_crudo["PRECTOTCORR"] == 0).sum()

print("D√≠as totales:", dias_totales)
print("D√≠as sin lluvia:", dias_sin_lluvia)
print("Porcentaje de d√≠as sin lluvia:",
      round(dias_sin_lluvia / dias_totales * 100, 2), "%")

lluvia_total = df_clima_crudo["PRECTOTCORR"].sum()

dias_intensos = df_clima_crudo[df_clima_crudo["PRECTOTCORR"] > 20]

lluvia_intensa_total = dias_intensos["PRECTOTCORR"].sum()

print("Lluvia total acumulada:", round(lluvia_total, 2), "mm")
print("Lluvia en d√≠as intensos (>20mm):", round(lluvia_intensa_total, 2), "mm")
print("Porcentaje del agua que cay√≥ en d√≠as intensos:",
      round(lluvia_intensa_total / lluvia_total * 100, 2), "%")

"""### üîπ Resultados Obtenidos

- **D√≠as totales analizados:** 83.996  
- **D√≠as sin lluvia:** 42.585  
- **Porcentaje de d√≠as sin lluvia:** 50,7 %

- **Lluvia total acumulada:** 189.388 mm  
- **Lluvia en d√≠as intensos (>20 mm):** 95.260 mm  
- **Porcentaje del agua concentrada en d√≠as intensos:** 50,3 %


### üîπ Conclusi√≥n y Observaci√≥n de los Datos

Los resultados muestran un patr√≥n clim√°tico altamente concentrado:

- M√°s del 50 % de los d√≠as no registran lluvia.  
- Sin embargo, aproximadamente el 50 % del volumen total de agua cae en d√≠as con precipitaciones intensas (>20 mm).

Esto indica que el r√©gimen h√≠drico no es uniforme, sino que se caracteriza por:

- Alta frecuencia de d√≠as secos.  
- Eventos de lluvia concentrados y de alta intensidad.

Desde una perspectiva agroclim√°tica, este patr√≥n puede implicar:

- Mayor riesgo de estr√©s h√≠drico entre eventos.  
- Dependencia de lluvias intensas para completar el acumulado anual.  
- Posible aumento del riesgo de erosi√≥n o anegamiento en determinados per√≠odos.

---

## ¬øCu√°les son las Provincias con Mayor Humedad Relativa Promedio?

En esta secci√≥n se analiza la humedad relativa media anual por provincia durante el per√≠odo 2014‚Äì2023.

La humedad relativa es una variable clave en climatolog√≠a, ya que influye en:

- La sensaci√≥n t√©rmica.
- La evaporaci√≥n del agua.
- El desarrollo de cultivos.
- La proliferaci√≥n de enfermedades f√∫ngicas.

A diferencia de la precipitaci√≥n, la humedad relativa no mide directamente la cantidad de lluvia, sino la proporci√≥n de vapor de agua presente en el aire en relaci√≥n con su capacidad m√°xima.

El objetivo es identificar qu√© provincias presentan los niveles promedio m√°s elevados de humedad ambiental.
"""

# =========================================
# TOP 10 PROVINCIAS CON MAYOR HUMEDAD
# =========================================

import matplotlib.pyplot as plt
import seaborn as sns

# 1Ô∏è‚É£ Promedio de humedad por provincia
humedad_por_provincia = (
    df_clima_crudo
    .groupby("provincia")["RH2M"]
    .mean()
    .sort_values(ascending=False)
)

# 2Ô∏è‚É£ Top 10
top_10_humedad = humedad_por_provincia.head(10)

print("Top 10 Provincias con Mayor Humedad Promedio (2014-2023):")
display(top_10_humedad)

# 3Ô∏è‚É£ Gr√°fico
plt.figure(figsize=(10, 6))
sns.barplot(
    x=top_10_humedad.values,
    y=top_10_humedad.index,
    palette="coolwarm"
)

plt.title("Top 10 Provincias con Mayor Humedad Promedio (2014‚Äì2023)", fontsize=14)
plt.xlabel("Humedad Relativa Promedio (%)")
plt.ylabel("Provincia")
plt.show()

"""### üîπ Conclusi√≥n y Observaci√≥n de los Datos

El an√°lisis muestra que **Tierra del Fuego** lidera el ranking de humedad relativa promedio, seguida por **Misiones** y provincias patag√≥nicas como **Santa Cruz** y **Chubut**.

Se observan dos patrones interesantes:

- Provincias del noreste argentino (NEA), como **Misiones**, **Chaco** y **Corrientes**, presentan alta humedad asociada a climas subtropicales.
- Provincias del sur del pa√≠s, como **Tierra del Fuego** y **Santa Cruz**, muestran alta humedad relativa aunque no necesariamente registren los mayores niveles de precipitaci√≥n.

Esto confirma que la humedad relativa no depende √∫nicamente de la cantidad de lluvia, sino tambi√©n de factores como:

- Temperatura
- Latitud
- Cercan√≠a al mar

Desde una perspectiva agroclim√°tica, altos niveles de humedad pueden:

- Favorecer determinados cultivos.
- Aumentar el riesgo de enfermedades f√∫ngicas.
- Influir en la planificaci√≥n de calendarios productivos.

---

## ¬øQu√© provincias tienen m√°s eventos (rachas) de lluvia a lo largo del per√≠odo 2014‚Äì2023?

El an√°lisis de rachas permite comprender no solo cu√°nto llueve, sino c√≥mo se distribuye la lluvia en el tiempo.

En el caso de Chubut, se registraron 687 rachas de lluvia durante el per√≠odo 2014‚Äì2023. Esto equivale aproximadamente a 69 rachas por a√±o, es decir, en promedio, el inicio de una secuencia de lluvia cada 5 a 6 d√≠as.

Sin embargo, es importante aclarar que una racha no representa un √∫nico d√≠a de lluvia, sino el comienzo de una secuencia consecutiva de d√≠as con precipitaci√≥n.

Desde una perspectiva productiva, este dato sugiere que:

- La lluvia puede ser relativamente frecuente.
- Los eventos podr√≠an estar fragmentados en secuencias cortas.
- La disponibilidad h√≠drica depender√° no solo de la frecuencia, sino tambi√©n de la duraci√≥n e intensidad de cada racha.

En t√©rminos agr√≠colas, comprender la estructura temporal de la lluvia es m√°s relevante que observar √∫nicamente el acumulado anual, ya que impacta directamente en la infiltraci√≥n del suelo, la retenci√≥n de humedad y la planificaci√≥n del riego.

---
"""

import pandas as pd
import plotly.express as px

# ============================================================
# 0) Asegurar columna de fecha (ajust√° si tu columna se llama distinto)
# ============================================================
df = df_clima_crudo.copy()

# Intento de detecci√≥n autom√°tica de columna de fecha
possible_date_cols = ["fecha", "date", "datetime", "time", "timestamp"]
date_col = next((c for c in possible_date_cols if c in df.columns), None)

if date_col is None:
    raise ValueError(
        "No encontr√© una columna de fecha. "
        "Cre√° una columna 'fecha' o decime c√≥mo se llama tu columna de fecha."
    )

df[date_col] = pd.to_datetime(df[date_col])

# ============================================================
# 1) Definir d√≠as con lluvia y ordenar
# ============================================================
# Umbral: si quer√©s evitar ‚Äúlloviznas‚Äù o ruido, pod√©s usar 0.1 en vez de 0
RAIN_EPS = 0.0
df["llovio"] = df["PRECTOTCORR"] > RAIN_EPS

df = df.sort_values(["provincia", date_col])

# ============================================================
# 2) Detectar INICIO de racha
#    inicio_racha = llovio HOY y NO llovio AYER (dentro de la misma provincia)
# ============================================================
df["llovio_ayer"] = df.groupby("provincia")["llovio"].shift(1, fill_value=False)
df["inicio_racha"] = df["llovio"] & (~df["llovio_ayer"])

# ============================================================
# 3) Contar rachas por provincia
# ============================================================
rachas_prov = (
    df.groupby("provincia", as_index=False)["inicio_racha"]
    .sum()
    .rename(columns={"inicio_racha": "rachas_lluvia"})
    .sort_values("rachas_lluvia", ascending=False)
)

display(rachas_prov.head(10))

# ============================================================
# 4) Gr√°fico principal: rachas por provincia
# ============================================================
fig = px.bar(
    rachas_prov,
    x="provincia",
    y="rachas_lluvia",
    title="Cantidad de Rachas de Lluvia por Provincia (2014‚Äì2023)",
    labels={"provincia": "Provincia", "rachas_lluvia": "Rachas de lluvia (inicio de secuencias)"},
)
fig.update_layout(xaxis_tickangle=-45)
fig.show()

# ============================================================
# 5) (Opcional) Resaltar una provincia espec√≠fica (ej: Chubut)
# ============================================================
prov_obj = "Chubut"
if prov_obj in set(rachas_prov["provincia"]):
    valor = int(rachas_prov.loc[rachas_prov["provincia"] == prov_obj, "rachas_lluvia"].iloc[0])
    print(f"üìå {prov_obj}: {valor} rachas en 2014‚Äì2023 (‚âà {valor/10:.1f} rachas/a√±o)")
else:
    print(f"‚ö†Ô∏è No encontr√© '{prov_obj}' en la columna provincia. Revisa el nombre exacto.")

"""Se observa una marcada heterogeneidad en la cantidad de rachas de lluvia entre provincias durante el per√≠odo analizado.

- **Chubut y R√≠o Negro** presentan los valores m√°s altos (cerca de 700 rachas en el per√≠odo).
- En el extremo opuesto, **Tierra del Fuego** muestra una cantidad considerablemente menor.
- El grupo central de provincias (Buenos Aires, Misiones, Santa Fe, Entre R√≠os, La Pampa, Chaco, Corrientes, entre otras) se mantiene en un rango relativamente estable entre 450 y 500 rachas aproximadamente.


## Interpretaci√≥n Productiva

Estos resultados sugieren que:

- En provincias como **Chubut**, la lluvia tiende a fragmentarse en m√∫ltiples eventos peque√±os o secuencias cortas.
- Esto no implica necesariamente mayor volumen total de lluvia, sino mayor **frecuencia de eventos**.
- En provincias con menor cantidad de rachas, la lluvia podr√≠a estar m√°s concentrada en eventos m√°s prolongados o menos frecuentes.

## Enfoque Agr√≠cola

Desde una perspectiva productiva:

- Una mayor cantidad de rachas implica mayor frecuencia de inicio de eventos lluviosos.
- Esto impacta en la planificaci√≥n de siembra, cosecha y manejo de maquinaria.
- Tambi√©n influye en la infiltraci√≥n del suelo y la retenci√≥n de humedad.

En t√©rminos agr√≠colas, no solo importa cu√°nto llueve, sino **c√≥mo se distribuye temporalmente la lluvia**, ya que esa estructura condiciona el rendimiento potencial del cultivo.

---

## √çndice de Riesgo de Evaporaci√≥n: Interpretaci√≥n Agroclim√°tica

Luego de analizar la precipitaci√≥n, la humedad y la temperatura por separado, se construye un √≠ndice simple de riesgo evaporativo para evaluar la posible p√©rdida de agua desde el suelo hacia la atm√≥sfera.

El √≠ndice se define como:

√çndice de evaporaci√≥n = (Temperatura media √ó Velocidad del viento) / Humedad relativa

Este indicador no mide evaporaci√≥n real, sino un potencial relativo de p√©rdida h√≠drica, basado en tres factores clave:

- Mayor temperatura ‚Üí m√°s energ√≠a disponible para evaporar.
- Mayor viento ‚Üí mayor transporte del vapor de agua.
- Menor humedad relativa ‚Üí mayor capacidad del aire para absorber agua.

El objetivo es comparar provincias en t√©rminos de presi√≥n clim√°tica sobre la humedad del suelo.
"""

import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# 1Ô∏è‚É£ Creamos el √≠ndice simple de evaporaci√≥n
df_clima_crudo["indice_evaporacion"] = (
    df_clima_crudo["T2M"] * df_clima_crudo["WS2M"] / df_clima_crudo["RH2M"]
)

# 2Ô∏è‚É£ Promedio por provincia
evap_prov = (
    df_clima_crudo
    .groupby("provincia")["indice_evaporacion"]
    .mean()
    .sort_values(ascending=False)
)

# 3Ô∏è‚É£ Top 10 provincias con mayor riesgo evaporativo
top_10_evap = evap_prov.head(10)

# 4Ô∏è‚É£ Gr√°fico
plt.figure(figsize=(10,6))
sns.barplot(x=top_10_evap.values, y=top_10_evap.index)

plt.title("Top 10 Provincias con Mayor √çndice de Riesgo de Evaporaci√≥n (2014‚Äì2023)")
plt.xlabel("√çndice Evaporaci√≥n (relativo)")
plt.ylabel("Provincia")

plt.show()

# 5Ô∏è‚É£ Mostrar valores
display(top_10_evap)

"""El ranking muestra que provincias como **San Juan, Neuqu√©n y Mendoza** presentan los valores m√°s elevados del √≠ndice evaporativo relativo.

Esto es coherente con sus caracter√≠sticas clim√°ticas:

- Temperaturas elevadas.
- Baja humedad relativa.
- Mayor exposici√≥n a viento.
- Climas √°ridos o semi√°ridos.

Desde una perspectiva agr√≠cola, un mayor √≠ndice de evaporaci√≥n implica:

- Mayor p√©rdida potencial de agua del suelo.
- Mayor demanda de riego.
- Menor permanencia de humedad disponible para cultivos.

Este an√°lisis complementa los estudios previos de precipitaci√≥n y humedad, permitiendo comprender no solo cu√°nto agua ingresa al sistema, sino tambi√©n qu√© tan r√°pido puede perderse.

---

## ¬øCu√°les son las provincias que presentan mayor porcentaje de d√≠as con viento intenso?

Adem√°s de la lluvia y la evaporaci√≥n, el viento es un factor clave en el comportamiento clim√°tico y productivo.

En este an√°lisis se define **viento fuerte** como aquellos d√≠as donde la velocidad supera los **6 m/s** (aproximadamente 21,6 km/h).  

El objetivo es identificar qu√© provincias presentan mayor porcentaje de d√≠as con viento intenso, ya que esto puede influir en:

- Mayor evaporaci√≥n del suelo.
- Estr√©s en cultivos.
- Mayor p√©rdida de humedad superficial.
- Impacto en infraestructura rural.
"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# 1Ô∏è‚É£ Definir umbral de viento fuerte
umbral_viento = 6  # m/s

# 2Ô∏è‚É£ Crear columna booleana
df_clima_crudo["viento_fuerte"] = df_clima_crudo["WS2M"] > umbral_viento

# 3Ô∏è‚É£ Calcular porcentaje de d√≠as con viento fuerte por provincia
viento_fuerte_por_prov = (
    df_clima_crudo
    .groupby("provincia")["viento_fuerte"]
    .mean() * 100
).sort_values(ascending=False)

# 4Ô∏è‚É£ Mostrar Top 10
top_10_viento = viento_fuerte_por_prov.head(10)

# 5Ô∏è‚É£ Gr√°fico tipo dot plot (m√°s profesional que barras)
plt.figure(figsize=(10,6))
plt.scatter(top_10_viento.values, top_10_viento.index)

plt.title("Top 10 Provincias con Mayor % de D√≠as con Viento Fuerte (>6 m/s)")
plt.xlabel("Porcentaje de d√≠as (%)")
plt.ylabel("Provincia")

plt.show()

# 6Ô∏è‚É£ Mostrar valores num√©ricos
display(top_10_viento.round(2))

"""### üîπ Conclusi√≥n

Los resultados muestran que **Tierra del Fuego, Chubut y Santa Cruz** lideran el ranking de d√≠as con viento fuerte, con valores superiores al 25%.

Esto indica que en estas provincias:

- M√°s de 1 de cada 4 d√≠as presenta viento intenso.
- El ambiente favorece mayor p√©rdida de humedad.
- El manejo agr√≠cola debe considerar protecci√≥n contra viento y planificaci√≥n de riego.

En contraste, provincias del norte presentan porcentajes significativamente menores.

Este an√°lisis complementa los estudios de lluvia y evaporaci√≥n, mostrando que no solo importa cu√°nto llueve, sino tambi√©n qu√© condiciones ambientales pueden acelerar la p√©rdida de agua.

---

## Visualizaci√≥n Din√°mica: Mapa Interactivo de Variables Clim√°ticas por Provincia

Hasta este punto, los an√°lisis se basaron en gr√°ficos est√°ticos (barras, dispersi√≥n e histogramas) que permiten comparar provincias de forma puntual.  
Para esta ocasi√≥n, incorporamos una visualizaci√≥n **m√°s din√°mica e interactiva** mediante un **mapa de Argentina con capas**, lo que facilita explorar el comportamiento clim√°tico por regi√≥n y comparar variables directamente sobre el territorio.

El mapa resume promedios provinciales del per√≠odo 2014‚Äì2023 e integra cuatro variables clave:

- **Lluvia promedio** (mm/d√≠a)  
- **Temperatura media** (¬∞C)  
- **Viento medio** (km/h)  
- **Humedad promedio** (%)  

El usuario puede activar/desactivar capas para analizar patrones espaciales y, al hacer clic en cada provincia, visualizar un resumen multivariable en un popup.
"""

import folium
print ("Instalado ")

# ============================================================
# MAPA ARGENTINA ‚Äî Promedios por Provincia
# Variables: Lluvia (mm/d√≠a) + Temp (¬∞C) + Viento (km/h) + Humedad (%)
# Requiere: df_clima_crudo con columnas:
#   provincia, PRECTOTCORR, T2M, WS2M, RH2M
# ============================================================

import folium

# -----------------------------
# 1) Agregaci√≥n por provincia
# -----------------------------
df_prov = (
    df_clima_crudo
    .groupby("provincia", as_index=False)
    .agg(
        lluvia_media=("PRECTOTCORR", "mean"),
        temp_media=("T2M", "mean"),
        viento_ms=("WS2M", "mean"),
        humedad_media=("RH2M", "mean")
    )
)

# Convertir viento de m/s a km/h (como ven√≠as trabajando)
df_prov["viento_kmh"] = df_prov["viento_ms"] * 3.6

# -----------------------------
# 2) Coordenadas (centros aproximados por provincia)
# -----------------------------
coordenadas = {
    "Buenos Aires": (-34.61, -58.38),
    "C√≥rdoba": (-31.42, -64.18),
    "Santa Fe": (-31.63, -60.70),
    "Mendoza": (-32.89, -68.84),
    "Tucum√°n": (-26.83, -65.22),
    "Salta": (-24.78, -65.41),
    "Misiones": (-27.37, -55.90),
    "Chaco": (-27.45, -58.98),
    "Corrientes": (-27.47, -58.83),
    "Formosa": (-26.18, -58.17),
    "Entre R√≠os": (-31.73, -60.53),
    "San Juan": (-31.53, -68.52),
    "San Luis": (-33.30, -66.33),
    "La Pampa": (-36.62, -64.29),
    "R√≠o Negro": (-40.81, -63.00),
    "Neuqu√©n": (-38.95, -68.06),
    "Chubut": (-43.30, -65.10),
    "Santa Cruz": (-51.62, -69.22),
    "Tierra del Fuego": (-54.80, -68.30),
    "La Rioja": (-29.41, -66.86),
    "Catamarca": (-28.47, -65.78),
    "Santiago del Estero": (-27.80, -64.26),
    "Jujuy": (-24.19, -65.30),
}

df_prov["lat"] = df_prov["provincia"].map(lambda x: coordenadas.get(x, (None, None))[0])
df_prov["lon"] = df_prov["provincia"].map(lambda x: coordenadas.get(x, (None, None))[1])

faltantes = df_prov[df_prov[["lat", "lon"]].isna().any(axis=1)]["provincia"].unique()
if len(faltantes) > 0:
    print("‚ö†Ô∏è Provincias sin coordenadas (revisar nombres):", list(faltantes))

df_prov = df_prov.dropna(subset=["lat", "lon"]).copy()

# -----------------------------
# 3) Mapa base + capas (FeatureGroup)
# -----------------------------
m = folium.Map(location=[-38.41, -63.61], zoom_start=4, tiles="cartodbpositron")

capa_lluvia = folium.FeatureGroup(name="üåßÔ∏è Lluvia promedio (mm/d√≠a)", show=True)
capa_temp   = folium.FeatureGroup(name="üå°Ô∏è Temperatura media (¬∞C)", show=False)
capa_viento = folium.FeatureGroup(name="üí® Viento medio (km/h)", show=False)
capa_hum    = folium.FeatureGroup(name="üíß Humedad promedio (%)", show=False)

# Normalizaci√≥n simple para tama√±os (radio) sin librer√≠as extra
def scale_radius(series, rmin=6, rmax=18):
    smin, smax = float(series.min()), float(series.max())
    if smax == smin:
        return [ (rmin + rmax) / 2 ] * len(series)
    return list(rmin + (series - smin) * (rmax - rmin) / (smax - smin))

df_prov["r_lluvia"] = scale_radius(df_prov["lluvia_media"])
df_prov["r_temp"]   = scale_radius(df_prov["temp_media"])
df_prov["r_viento"] = scale_radius(df_prov["viento_kmh"])
df_prov["r_hum"]    = scale_radius(df_prov["humedad_media"])

# -----------------------------
# 4) Marcadores por capa + popup multivariable
# -----------------------------
for _, row in df_prov.iterrows():
    popup_html = f"""
    <b>{row['provincia']}</b><br>
    üåßÔ∏è Lluvia: {row['lluvia_media']:.2f} mm/d√≠a<br>
    üå°Ô∏è Temp: {row['temp_media']:.2f} ¬∞C<br>
    üí® Viento: {row['viento_kmh']:.2f} km/h<br>
    üíß Humedad: {row['humedad_media']:.2f} %
    """

    # Lluvia
    folium.CircleMarker(
        location=[row["lat"], row["lon"]],
        radius=row["r_lluvia"],
        color="blue",
        fill=True,
        fill_opacity=0.55,
        popup=folium.Popup(popup_html, max_width=260),
        tooltip=f"{row['provincia']} ‚Äî {row['lluvia_media']:.2f} mm/d√≠a"
    ).add_to(capa_lluvia)

    # Temperatura
    folium.CircleMarker(
        location=[row["lat"], row["lon"]],
        radius=row["r_temp"],
        color="red",
        fill=True,
        fill_opacity=0.55,
        popup=folium.Popup(popup_html, max_width=260),
        tooltip=f"{row['provincia']} ‚Äî {row['temp_media']:.2f} ¬∞C"
    ).add_to(capa_temp)

    # Viento
    folium.CircleMarker(
        location=[row["lat"], row["lon"]],
        radius=row["r_viento"],
        color="purple",
        fill=True,
        fill_opacity=0.55,
        popup=folium.Popup(popup_html, max_width=260),
        tooltip=f"{row['provincia']} ‚Äî {row['viento_kmh']:.2f} km/h"
    ).add_to(capa_viento)

    # Humedad
    folium.CircleMarker(
        location=[row["lat"], row["lon"]],
        radius=row["r_hum"],
        color="green",
        fill=True,
        fill_opacity=0.55,
        popup=folium.Popup(popup_html, max_width=260),
        tooltip=f"{row['provincia']} ‚Äî {row['humedad_media']:.2f} %"
    ).add_to(capa_hum)

# Agregar capas y control
capa_lluvia.add_to(m)
capa_temp.add_to(m)
capa_viento.add_to(m)
capa_hum.add_to(m)

folium.LayerControl(collapsed=False).add_to(m)

# Mostrar mapa
m

"""El mapa interactivo permite observar con mayor claridad la distribuci√≥n espacial de las variables clim√°ticas, facilitando comparaciones directas entre regiones.

Se destacan patrones regionales consistentes con los an√°lisis previos:

- El **NEA** tiende a concentrar mayores valores de **lluvia y humedad**, lo que sugiere alta disponibilidad h√≠drica.
- Regiones **√°ridas/semi√°ridas** del oeste y centro muestran condiciones m√°s propensas a p√©rdida de agua por combinaci√≥n de **temperatura y viento**.
- Las provincias del sur presentan con frecuencia **vientos m√°s intensos**, lo que puede aumentar el riesgo evaporativo incluso con temperaturas bajas.

Este tipo de visualizaci√≥n complementa los gr√°ficos tradicionales al incorporar el componente geogr√°fico, ofreciendo una herramienta m√°s intuitiva para an√°lisis clim√°tico y toma de decisiones en contextos agr√≠colas.

---
"""

import plotly.express as px

# ============================================================
# üå¶Ô∏è CLUSTERS CLIM√ÅTICOS CON INTERPRETACI√ìN HUMANA
# ============================================================

import numpy as np
import pandas as pd
import plotly.express as px

from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans

# 1Ô∏è‚É£ Resumen por provincia
df_clima_prov = (
    df_clima_crudo
    .groupby("provincia", as_index=False)
    .agg(
        temp_media=("T2M", "mean"),
        lluvia_media=("PRECTOTCORR", "mean"),
        viento_medio=("WS2M", "mean"),
        humedad_media=("RH2M", "mean"),
    )
)

# 2Ô∏è‚É£ Escalado + clustering
features = ["temp_media", "lluvia_media", "viento_medio", "humedad_media"]
X = df_clima_prov[features]

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

kmeans = KMeans(n_clusters=3, random_state=42, n_init=10)
df_clima_prov["cluster"] = kmeans.fit_predict(X_scaled)

# ------------------------------------------------------------
# 3Ô∏è‚É£ Interpretaci√≥n manual basada en promedios
# ------------------------------------------------------------

cluster_labels = {
    0: "Fr√≠o y H√∫medo",
    1: "C√°lido y Seco",
    2: "Templado Intermedio"
}

df_clima_prov["perfil_climatico"] = df_clima_prov["cluster"].map(cluster_labels)

# ------------------------------------------------------------
# 4Ô∏è‚É£ Visualizaci√≥n 2D con nombres reales
# ------------------------------------------------------------

fig2d = px.scatter(
    df_clima_prov,
    x="temp_media",
    y="lluvia_media",
    color="perfil_climatico",
    hover_name="provincia",
    title="Perfiles Clim√°ticos Provinciales (2014‚Äì2023)",
    labels={
        "temp_media": "Temperatura media (¬∞C)",
        "lluvia_media": "Precipitaci√≥n media (mm/d√≠a)",
        "perfil_climatico": "Perfil Clim√°tico"
    }
)

fig2d.update_traces(marker=dict(size=12, opacity=0.9, line=dict(width=1, color="black")))
fig2d.show()

"""El an√°lisis permite identificar tres perfiles clim√°ticos diferenciados entre las provincias argentinas:

‚Ä¢ **Templado Intermedio**: Provincias con temperaturas medias moderadas y niveles de precipitaci√≥n relativamente elevados. Representan regiones con condiciones clim√°ticas m√°s equilibradas.

‚Ä¢ **C√°lido y Seco**: Provincias con temperaturas medias m√°s altas pero con menor nivel de precipitaci√≥n promedio, lo que sugiere mayor exposici√≥n a condiciones de estr√©s h√≠drico.

‚Ä¢ **Fr√≠o y H√∫medo**: Provincias con temperaturas medias m√°s bajas y niveles variables de precipitaci√≥n, asociadas principalmente a regiones del sur del pa√≠s.

En t√©rminos generales, se observa una tendencia positiva moderada entre temperatura media y precipitaci√≥n promedio en ciertos grupos, aunque no de manera uniforme en todo el territorio.

Este agrupamiento confirma la existencia de patrones clim√°ticos estructurales diferenciados a nivel provincial durante el per√≠odo 2014‚Äì2023.

---

## An√°lisis de Correlaci√≥n ‚Äî Promedios Clim√°ticos por Provincia (2014‚Äì2023)

Para comprender c√≥mo se relacionan entre s√≠ las variables clim√°ticas principales, calculamos una **matriz de correlaci√≥n de Pearson** utilizando los promedios por provincia:

- Temperatura media  
- Lluvia media  
- Viento medio  
- Humedad media
"""

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Resumen por provincia
df_prov = (
    df_clima_crudo.groupby("provincia", as_index=False)
    .agg(
        temp_media=("T2M", "mean"),
        lluvia_media=("PRECTOTCORR", "mean"),
        viento_media=("WS2M", "mean"),
        humedad_media=("RH2M", "mean")
    )
)

df_corr_prov = df_prov[["temp_media", "lluvia_media", "viento_media", "humedad_media"]]

corr_prov = df_corr_prov.corr(method="pearson")

print("=== Matriz de correlaci√≥n (promedios por provincia) ===")
display(corr_prov)

plt.figure(figsize=(7,5))
sns.heatmap(corr_prov, annot=True, cmap="coolwarm", fmt=".2f", vmin=-1, vmax=1)
plt.title("Matriz de correlaci√≥n (promedios por provincia) ‚Äî Clima Argentina 2014‚Äì2023")
plt.show()

"""üîπ **Temperatura vs Lluvia (0.53)**  
Existe una correlaci√≥n positiva moderada. En promedio provincial, las zonas m√°s c√°lidas tienden a presentar mayor lluvia.

üîπ **Lluvia vs Humedad (0.63)**  
Es la relaci√≥n m√°s fuerte observada. A mayor precipitaci√≥n, mayor humedad relativa. Esto es coherente desde el punto de vista f√≠sico.

üîπ **Temperatura vs Viento (-0.53)**  
Relaci√≥n negativa moderada. Las provincias m√°s ventosas tienden a ser menos c√°lidas (principalmente regiones patag√≥nicas).

üîπ **Temperatura vs Humedad (-0.11)**  
Relaci√≥n d√©bil. La temperatura promedio no explica directamente la humedad promedio a nivel provincial.

üîπ **Viento vs Lluvia (-0.39)**  
Relaci√≥n negativa moderada. En promedio, provincias m√°s ventosas tienden a tener menor lluvia media.

## ¬øQu√© nos dice esto para el an√°lisis clim√°tico?

- La **humedad est√° fuertemente asociada a la lluvia**, lo cual valida la consistencia del dataset.
- El **viento aparece como un factor diferenciador regional**.
- La temperatura influye, pero no es la √∫nica variable determinante del r√©gimen h√≠drico.
- No hay multicolinealidad extrema (no hay valores cercanos a ¬±1), lo cual es positivo si luego usamos estas variables en un modelo de ML.

# Conclusi√≥n General ‚Äì An√°lisis Clim√°tico Provincial (2014‚Äì2023)

A lo largo de este proyecto se trabaj√≥ con datos clim√°ticos reales obtenidos mediante la API oficial de NASA POWER, con el objetivo de comprender c√≥mo se comporta el clima argentino a nivel provincial y qu√© implicancias puede tener este comportamiento para el contexto agr√≠cola.

El an√°lisis permiti√≥ ir m√°s all√° de simples promedios anuales. No solo se observ√≥ cu√°nto llueve o qu√© temperatura media presenta cada provincia, sino tambi√©n c√≥mo se distribuyen esos eventos en el tiempo, c√≥mo se relacionan entre s√≠ las distintas variables clim√°ticas y qu√© patrones estructurales emergen cuando se analizan en conjunto.

Se identificaron diferencias claras entre provincias, tanto en frecuencia de rachas de lluvia como en niveles de humedad, temperatura y viento. El an√°lisis de clustering permiti√≥ detectar perfiles clim√°ticos diferenciados, evidenciando que el territorio argentino no presenta un comportamiento homog√©neo, sino que se organiza en tipolog√≠as ambientales con caracter√≠sticas propias.

Desde una perspectiva productiva, esto es relevante porque el rendimiento agr√≠cola no depende √∫nicamente del suelo o del volumen total de precipitaciones, sino tambi√©n de la din√°mica temporal del clima. La frecuencia de d√≠as secos, la concentraci√≥n de eventos intensos, la persistencia de humedad o las variaciones t√©rmicas pueden modificar significativamente las condiciones de producci√≥n.

En definitiva, este trabajo permiti√≥ contextualizar el entorno clim√°tico real en el que se desarrollan los cultivos en Argentina. M√°s que ofrecer una predicci√≥n puntual, el an√°lisis aporta comprensi√≥n estructural: entender el clima como sistema, reconocer sus patrones y visualizar c√≥mo se distribuyen sus caracter√≠sticas en el territorio.

Este enfoque complementa el modelo predictivo desarrollado previamente y sienta una base s√≥lida para futuras integraciones entre datos clim√°ticos reales y modelos de rendimiento agr√≠cola.

---
"""